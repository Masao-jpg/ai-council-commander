# AI Council Commander v3.1.0 - 変更履歴

## 🎉 主な変更点

### 1. 評議会メンバーの刷新

**旧構成** → **新構成**
- ~~Planner~~ → **Visionary** (🔵 起案・情熱)
- ~~Critic~~ → 以下に分割:
  - **Analyst** (⚪ 分析・根拠)
  - **Guardian** (🔴 安全・リスク)
- 追加: **Realist** (🟠 現実・兵站)
- **Moderator** (🟢 書記・進行) - 継続

### 2. 4フェーズ議論システムの導入

議論が以下の4つのフェーズに構造化されました：

#### Phase 1: 定義・目標設定 (8 turns)
- **目的**: 現状把握とゴールの定義
- **発言配分**:
  - Visionary: 3回
  - Analyst: 3回
  - Moderator: 2回

#### Phase 2: 分析・要因究明 (12 turns)
- **目的**: 原因の深掘り、ギャップ分析
- **発言配分**:
  - Analyst: 4回
  - Guardian: 4回
  - Visionary: 2回
  - Moderator: 2回

#### Phase 3: 対策立案・計画 (12 turns)
- **目的**: 解決策のアイデア出しと具体化
- **発言配分**:
  - Visionary: 4回
  - Realist: 4回
  - Analyst: 2回
  - Moderator: 2回

#### Phase 4: 最終確認・計画策定 (8 turns)
- **目的**: リスク評価と実行計画の確定
- **発言配分**:
  - Guardian: 3回
  - Realist: 3回
  - Moderator: 2回

**合計**: 40 turns

### 3. デッキ方式による確定回数制

- **旧方式**: ランダム抽選（確率ベース）
- **新方式**: デッキ方式（確定回数制）
  - 各フェーズ開始時に発言者リストを生成
  - 全員が規定回数を必ず消化
  - シャッフルにより順序はランダム化

### 4. チェックポイント機能

各フェーズ終了時（Turn 8, 20, 32）で自動停止：
- 黄色のチェックポイントUIが表示
- ユーザーが「次のフェーズへ進む」ボタンを押すまで待機
- フェーズ間でユーザーが進行を制御可能

### 5. UIの改善

#### ヘッダー部分
- Phase表示: 現在のフェーズ名を表示
- Turn表示: 現在のターン数/総ターン数

#### 議論ストリーム
- 新しいエージェントの色分け表示
- チェックポイントUI
- 次フェーズ移行ボタン

#### 設定パネル
- 5人の評議員情報を表示
- 4フェーズの議論構造を説明

## 🔧 技術的変更

### Backend

#### 新規ファイル
- `server/src/councilConfig.ts` - エージェント定義とフェーズ設定

#### 主な変更
- `server/src/routes/debate.ts`
  - デッキ生成関数 `createSpeakerDeck()`
  - セッション管理の強化
  - フェーズ遷移API `/next-phase`
  - ターン実行API `/next-turn`

### Frontend

#### 新規ファイル
- `client/src/types.ts` - 型定義の集約

#### 主な変更
- `client/src/App.tsx`
  - フェーズ状態管理の追加
  - チェックポイント状態の管理
- `client/src/components/DebateStream.tsx`
  - デッキ方式の実装
  - チェックポイントUI
  - フェーズ遷移ロジック
- `client/src/components/CouncilSettings.tsx`
  - 新メンバー表示
  - フェーズ構造の説明
- `client/tailwind.config.js`
  - 新エージェント色の定義

## 📊 品質特性の対応

各エージェントが特定の品質特性を担当：

| エージェント | 品質特性 | 主な役割 |
|-------------|---------|---------|
| Visionary | 目的適合性 (Purpose/Value) | 理想とビジョンの提示 |
| Analyst | 正確性・準拠性 (Accuracy/Compliance) | データと根拠の提示 |
| Realist | 資源効率性・実現性 (Feasibility/Efficiency) | 実現可能性の検証 |
| Guardian | 安全性・信頼性 (Safety/Reliability) | リスクの洗い出し |
| Moderator | 合意形成 (Consensus) | 議論の統合と文書化 |

## 🚀 使用方法

1. 議題を入力
2. 「評議会を開始」ボタンをクリック
3. Phase 1 (8 turns) の議論を観察
4. チェックポイントで「Phase 2 へ進む」をクリック
5. Phase 2 (12 turns) の議論を観察
6. チェックポイントで「Phase 3 へ進む」をクリック
7. Phase 3 (12 turns) の議論を観察
8. チェックポイントで「Phase 4 へ進む」をクリック
9. Phase 4 (8 turns) の議論を観察
10. 「議論を完了する」をクリック
11. 「Run Claude」または「Export Doc」を実行

## 🎯 実装済み機能

✅ 5人のエージェント構成
✅ 4フェーズ議論システム
✅ デッキ方式による確定回数制
✅ チェックポイント機能（自動停止＋手動進行）
✅ フェーズごとの発言クォータ管理
✅ リアルタイムフェーズ・ターン表示
✅ Gemini 1.5 Pro 統合
✅ デスクトップショートカット対応

## 📝 注意事項

- 各フェーズは完全に独立しており、中断して後で再開することはできません
- フェーズ終了後は必ずチェックポイントが表示されます
- Moderatorは各フェーズで計画書を更新します
- 全40ターンの議論が完了するまで、最終的な計画書は完成しません

---

**バージョン**: 3.1.0 Dual-Output
**リリース日**: 2026-02-02
**API**: Gemini 1.5 Pro
